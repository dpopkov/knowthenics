<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    <changeSet author="denjd (generated)" id="1616964701431-1">
        <createTable tableName="answer_key_term">
            <column name="answer_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="key_term_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-2">
        <createTable tableName="answers">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="answer_type" type="VARCHAR(255)"/>
            <column name="comment" type="VARCHAR(255)"/>
            <column name="source_details" type="VARCHAR(255)"/>
            <column name="wording_en" type="LONGTEXT"/>
            <column name="wording_ru" type="LONGTEXT"/>
            <column name="question_id" type="BIGINT"/>
            <column name="source_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-3">
        <createTable tableName="categories">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-4">
        <createTable tableName="decks">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-5">
        <createTable tableName="flashcards">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="answer_wording" type="VARCHAR(255)"/>
            <column name="level" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="question_wording" type="VARCHAR(255)"/>
            <column name="deck_id" type="BIGINT"/>
            <column name="question_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-6">
        <createTable tableName="key_terms">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="name" type="VARCHAR(64)"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-7">
        <createTable tableName="qcollection_question">
            <column name="qcollection_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="question_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-8">
        <createTable tableName="qcollections">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="title" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-9">
        <createTable tableName="question_drill_stats">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="drill_count" type="INT"/>
            <column name="knowing_rate" type="DOUBLE"/>
            <column name="success_count" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-10">
        <createTable tableName="question_key_term">
            <column name="question_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="key_term_id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-11">
        <createTable tableName="questions">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="comment" type="VARCHAR(255)"/>
            <column name="usage_count" type="INT"/>
            <column name="short_answer_en" type="VARCHAR(255)"/>
            <column name="short_answer_ru" type="VARCHAR(255)"/>
            <column name="wording_en" type="VARCHAR(255)"/>
            <column name="wording_ru" type="VARCHAR(255)"/>
            <column name="category_id" type="BIGINT"/>
            <column name="preferred_answer_id" type="BIGINT"/>
            <column name="question_stat_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-12">
        <createTable tableName="sources">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="full_title" type="VARCHAR(255)"/>
            <column name="short_title" type="VARCHAR(128)"/>
            <column name="source_type" type="VARCHAR(255)"/>
            <column name="url" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-13">
        <createTable tableName="study_sessions">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="current_card_index" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="finished" type="datetime"/>
            <column name="started" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-14">
        <createTable tableName="study_sessions_flash_cards">
            <column name="study_session_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="flash_cards_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-15">
        <createTable tableName="topics">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="description" type="VARCHAR(255)"/>
            <column name="knowing_rate" type="DOUBLE"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="qcollection_id" type="BIGINT"/>
        </createTable>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-16">
        <createIndex indexName="FK__answer_key_term__key_term_id" tableName="answer_key_term">
            <column name="key_term_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-17">
        <createIndex indexName="FK__answers__question_id" tableName="answers">
            <column name="question_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-18">
        <createIndex indexName="FK__answers__source_id" tableName="answers">
            <column name="source_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-19">
        <createIndex indexName="FK__flashcards__deck_id" tableName="flashcards">
            <column name="deck_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-20">
        <createIndex indexName="FK__flashcards__question_id" tableName="flashcards">
            <column name="question_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-21">
        <createIndex indexName="FK__qcollection_question__question_id" tableName="qcollection_question">
            <column name="question_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-22">
        <createIndex indexName="FK__question_key_term__key_term_id" tableName="question_key_term">
            <column name="key_term_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-23">
        <createIndex indexName="FK__questions__category_id" tableName="questions">
            <column name="category_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-24">
        <createIndex indexName="FK__questions__preferred_answer_id" tableName="questions">
            <column name="preferred_answer_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-25">
        <createIndex indexName="FK__questions__question_stat_id" tableName="questions">
            <column name="question_stat_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-26">
        <createIndex indexName="FK__study_sessions_flash_cards__flash_cards_id" tableName="study_sessions_flash_cards">
            <column name="flash_cards_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-27">
        <createIndex indexName="FK__study_sessions_flash_cards__study_session_id" tableName="study_sessions_flash_cards">
            <column name="study_session_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-28">
        <createIndex indexName="FK__topics__qcollection_id" tableName="topics">
            <column name="qcollection_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-29">
        <addForeignKeyConstraint baseColumnNames="answer_id" baseTableName="answer_key_term" constraintName="FK__answer_key_term__answer_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="answers" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-30">
        <addForeignKeyConstraint baseColumnNames="key_term_id" baseTableName="answer_key_term" constraintName="FK__answer_key_term__key_term_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="key_terms" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-31">
        <addForeignKeyConstraint baseColumnNames="question_id" baseTableName="answers" constraintName="FK__answers__question_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="questions" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-32">
        <addForeignKeyConstraint baseColumnNames="source_id" baseTableName="answers" constraintName="FK__answers__source_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="sources" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-33">
        <addForeignKeyConstraint baseColumnNames="deck_id" baseTableName="flashcards" constraintName="FK__flashcards__deck_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="decks" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-34">
        <addForeignKeyConstraint baseColumnNames="question_id" baseTableName="flashcards" constraintName="FK__flashcards__question_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="questions" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-35">
        <addForeignKeyConstraint baseColumnNames="qcollection_id" baseTableName="qcollection_question" constraintName="FK__qcollection_question__qcollection_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="qcollections" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-36">
        <addForeignKeyConstraint baseColumnNames="question_id" baseTableName="qcollection_question" constraintName="FK__qcollection_question__question_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="questions" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-37">
        <addForeignKeyConstraint baseColumnNames="key_term_id" baseTableName="question_key_term" constraintName="FK__question_key_term__key_term_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="key_terms" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-38">
        <addForeignKeyConstraint baseColumnNames="question_id" baseTableName="question_key_term" constraintName="FK__question_key_term__question_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="questions" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-39">
        <addForeignKeyConstraint baseColumnNames="category_id" baseTableName="questions" constraintName="FK__questions__category_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="categories" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-40">
        <addForeignKeyConstraint baseColumnNames="preferred_answer_id" baseTableName="questions" constraintName="FK__questions__preferred_answer_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="answers" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-41">
        <addForeignKeyConstraint baseColumnNames="question_stat_id" baseTableName="questions" constraintName="FK__questions__question_stat_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="question_drill_stats" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-42">
        <addForeignKeyConstraint baseColumnNames="flash_cards_id" baseTableName="study_sessions_flash_cards" constraintName="FK__study_sessions_flash_cards__flash_cards_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="flashcards" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-43">
        <addForeignKeyConstraint baseColumnNames="study_session_id" baseTableName="study_sessions_flash_cards" constraintName="FK__study_sessions_flash_cards__study_session_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="study_sessions" validate="true"/>
    </changeSet>
    <changeSet author="denjd (generated)" id="1616964701431-44">
        <addForeignKeyConstraint baseColumnNames="qcollection_id" baseTableName="topics" constraintName="FK__topics__qcollection_id" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="qcollections" validate="true"/>
    </changeSet>
</databaseChangeLog>
